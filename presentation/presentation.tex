\documentclass{beamer}

\usepackage{booktabs}
\usepackage{amsthm}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{conjecture}[theorem]{Conjecture}
\newcommand{\QQ}{\mathbf{Q}}
\newcommand{\QQbar}{\overline{\mathbf{Q}}}
\newcommand{\RR}{\mathbf{R}}
\newcommand{\ZZ}{\mathbf{Z}}
\newcommand{\FF}{\mathbf{F}}
\newcommand{\TT}{\mathbf{T}}
\newcommand{\Jac}{\mathrm{Jac}}
\newcommand{\F}{\mathbf{F}}
\newcommand{\I}{\mathcal{I}}
\renewcommand{\H}{\mathcal{H}}
\renewcommand{\ZZ}{\mathbf{Z}}
\newcommand{\CC}{\mathbf{C}}
\newcommand{\SL}{\mathrm{SL}}
\renewcommand{\Im}{\mathrm{Im}}
\newcommand{\tor}{\mathrm{tor}}
\newcommand{\Ann}{\mathrm{Ann}}
\newcommand{\num}{\mathrm{num}}
\newcommand{\old}{\mathrm{old}}
\newcommand{\new}{\mathrm{new}}
\newcommand{\Cl}{\mathrm{Cl}}
\newcommand{\Hom}{\mathrm{Hom}}
\newcommand{\Frob}{\mathrm{Frob}}
\newcommand{\End}{\mathrm{End}}
\newcommand{\p}{\mathfrak{p}}

\usepackage{tikz-cd}

\usepackage{graphicx}
\usetheme[block=fill, progressbar=frametitle, numbering=fraction]{metropolis}
\definecolor{mPurple}{HTML}{4b2e83}
\setbeamercolor{palette primary}{%
    bg = mPurple
}

% \usefonttheme{professionalfonts} % required for mathspec
% \usepackage{mathspec}
% \setsansfont[BoldFont={Fira Sans},
% Numbers={OldStyle}]{Fira Sans Light}
% \setmathsfont(Digits)[Numbers={Lining, Proportional}]{Fira
% Sans Light}
\title{%
    Arithmetic of Totally Split Modular Jacobians and Enumeration of Isogeny
    Classes of Prime Level Simple Modular Abelian Varieties
}
\author{Kevin Lui\\Adviser: William Stein}
\date{May 30, 2019}
\institute{Final Exam}

\begin{document}
\frame{\titlepage}

\section{How I got started in my research}

\begin{frame}{Google Summer of Code}
    \begin{itemize}
        \item 
            Once upon a time, William implemented a lot of functionality
            for modular abelian varieties into MAGMA.
        \item
            William started Sage but some of the functionality never made it
            into Sage.
        \item
            I spent a summer working on improving some of the modular abelian
            variety code. Thanks Google!
    \end{itemize} 
\end{frame}

\begin{frame}{Table Making}
    \begin{itemize}
        \item
            Working on the code required me to study a paper that Hao and
            William were working on. I started working on this paper too.
        \item
            This paper had an outline of a table at the end. I tried to fill it
            in.
        \item
            It was hard.
   \end{itemize} 
\end{frame}

\begin{frame}{Research Goal}
    \Huge{Compute as many invariants as possible for modular abelian
    varieties}
\end{frame}

\begin{frame}{Thesis overview}
    I created methods to attack
    \begin{itemize}
        \item
            computing the rational torsion subgroup of modular
            Jacobian $J_0(N)$.
        \item
            enumerating the isogeny class of abelian subvarieties of
            $J_0(N)$.
    \end{itemize}
\end{frame}

\section{Some background on modular abelian varieties}

\begin{frame}{Modular Jacobian}
    \begin{itemize}
        \item
            The modular curves $X_0(N), X_1(N)$ is an algebraic curve defined
            over $\QQ$ which parameterizes elliptic curves with additional
            $N$-torsion data.
        \item 
            The Jacobians $J_0(N)=\Jac(X_0(N))$ and $J_1(N)=\Jac(X_1(N))$ are
            abelian varieties over $\QQ$.
    \end{itemize} 
\end{frame}

\begin{frame}{Modular Abelian Varieties}
    \begin{definition}[Modular Abelian Variety]
        An abelian variety $A$ is a \emph{modular} if there is a finite-degree
        morphism $\varphi:A\to J_1(N)$ for some $N$.
    \end{definition}
\end{frame}

\begin{frame}[fragile]{Defining Data}
Let $B$ be the image of $A$ in $J$.
Then there is an isogeny $B$ to $A$ with kernel $G$ such that $A\cong B/G$.
\begin{equation}
    \label{eq:defining_data}
    \begin{tikzcd}
        &
        &
        A \arrow[d]\arrow[dr,"\varphi"] &
        &
        &
        \\
        0 \arrow[r] &
        G \arrow[r] &
        B \arrow[r] &
        J \arrow[r] &
        0
    \end{tikzcd}
\end{equation}
So we can represent any modular abelian variety $J$ by giving $G\subseteq
B\subseteq J$ all defined over $\QQ$.
\end{frame}

\begin{frame}{Defining Data cont.}
    Recall $A\cong B/G$, $G\subseteq B \subseteq J$.
    \begin{itemize}
        \item
            (Defining $J$) Give a modular symbol basis for $H_1(J, \ZZ)\cong
            \ZZ^{2\mathrm{dim}(J)}$, $H_1(J, \QQ) = H_1(J, \ZZ)\otimes
            \QQ\cong \QQ^{2\mathrm{dim}(J)}$. So $J(\CC)_\tor$ is given as
            $H_1(J, \QQ)/H_1(J, \QQ)$.
        \item
            (Defining $B$) Give a basis for the subspace $V:=H_1(B,
            \QQ)\subseteq H_1(J, \QQ)$. Then $H_1(B, \ZZ)=V\cap H_1(J, \QQ)$.
        \item
            (Defining $G$) Give a basis for the lattice $L$, $H_1(B, \ZZ)
            \subseteq L \subseteq H_1(B, \QQ)$ such that $G\cong \Lambda/H_1(B,
            \ZZ)$.
    \end{itemize}
\end{frame}

\begin{frame}{Example}
    We give an example of the defining data of some elliptic curve factor of
    the 3-dimensional abelian variety $J_0(30)$. Here $B$ is the image of
    $J_0(15)\to J_0(30)$ under the degeneracy map corresponding to $1$ and $G$
    is the Shimura subgroup of $B$.
    \begin{itemize}
        \item
            (Defining $J$) A basis for our representation of $H_1(J, \ZZ)$ is
            $\{e_1,\ldots,e_6\}$.
        \item
            (Defining $B$) A basis for $H_1(B, \ZZ)$ is $\{(1,0,-1,1,0,1),
            (0,1,0,-1,1,0)\}$.
        \item
            (Defining $G$) A basis for $G$ is $\{(1/4, 1/2, -1/4, -1/4, 1/2,
            1/4), (0,1,0,-1,1,0)\}$.
    \end{itemize}
\end{frame}

\begin{frame}{Defining data for groups, morphisms}
    \begin{itemize}
        \item 
            (Define groups) Suppose $A\sim (L, V, J)$. A subgroup $H$ of
            $A(\QQbar)_\tor$ is specified by giving a lattice $\Lambda$ so that
            $H\cong \Lambda/L$. 
        \item
            (Define morphisms) Suppose $A\sim (L, V, J)$ and $B\sim (L', V', J')$.
            Then $A\to B$ can be specified by giving a map $V\to V'$ sending
            $L\to L'$.
    \end{itemize}

\end{frame}

\begin{frame}{Things we can do easily}
    \begin{itemize}
        \item
            Hecke operators, star-involution, degeneracy maps -- these can all
            be expressed using modular symbols.
        \item
            A decomposition of $A$ into a sum of its simple subvarieties. The
            simple new subvariety appear with multiplicity one, the simple old
            subvarieties are images of degeneracy maps.
        \item 
            Shimura and cuspidal subgroup -- Shimura is the kernel of a
            difference of degeneracy maps, cuspidal can be obtain via
            integration pairing.
    \end{itemize}
\end{frame}

\section{Computing rational torsion subgroup for $J_0(N)$}


\begin{frame}{Rational Torsion Subgroup}
    The \emph{cuspidal} subgroup, $C$, of $J_0(N)$ is the subgroup generated by
    degree-0 divisors of $X_0(N)$ of the form $(\alpha)-(\beta)$, where
    $\alpha,\beta$ are cusps.

    The rational points of $C$ form the \emph{rational cuspidal} subgroup
    $C(\QQ)\subseteq J_0(N)(\QQ)_\tor$. Ogg conjectured they are equal.

    \begin{theorem}[Mazur '77]
        If $N$ is prime, then
        \[
            C(\QQ)=J_0(N)(\QQ)_\tor.
        \]
    \end{theorem}
\end{frame}

\begin{frame}{Generalized Ogg Conjecture}
    \begin{conjecture}[Generalized Ogg Conjecture]
        Let $N$ be any positive integer and $C$ be the cuspidal subgroup of
        $J_0(N)$. Then
        \[
            C(\QQ) = J_0(N)(\QQ)_\tor.
        \]
    \end{conjecture}
\end{frame}

\begin{frame}{Progress of Generalized Ogg Conjecture}
    \begin{theorem}[Mazur '77]
        When $N$ is prime, $J_0(N)(\QQ)_\tor =C(\QQ)$.
    \end{theorem}
    \begin{theorem}[Ohta '14]
        When $N$ is a positive squarefree integer,
        \[
            J_0(N)(\QQ)[q^\infty]=C(\QQ)[q^\infty]
        \]
        for $q\nmid 6$.
    \end{theorem}
    \begin{theorem}[Yoo '15]
        When $p>3$,
        \[
            J_0(3p)(\QQ)[3^\infty] = C(3p)(\QQ)[3^\infty]
        \]
        unless $p\equiv 1 \pmod{9}$ and $3^{\frac{p-1}{3}} \equiv 1
        \pmod{9}$.
    \end{theorem}
\end{frame}

\begin{frame}{Progress of Generalized Ogg Conjecture cont.}
    \begin{theorem}[Ling '97]
        When $p\geq 5$ is a prime and $r$ a positive integer,
        \[
            J_0(p^r)(\QQ)[q^\infty] = C(p^r)(\QQ)[q^\infty]
        \]
        for any prime $q\nmid 6p$.
    \end{theorem}
    \begin{theorem}[Ren '18]
        When $N$ is any positive integer,
        \[
            J_0(N)(\QQ)[q^\infty]=C(\QQ)[q^\infty]
        \]
        for $q\nmid 6N\pi(N)$, where $\pi(N) = \prod_{p\mid N}
        (p^2-1)$.
    \end{theorem}
\end{frame}

\begin{frame}{Goal for Generalized Ogg Conjecture}
    \begin{itemize}
        \item 
            Verify $[J_0(N)(\QQ)_\tor:C(\QQ)]=1$ for any many $J_0(N)$ as
            possible.
        \item
            Bound $[J_0(N)(\QQ)_\tor:C(\QQ)]$ as best as possible.
    \end{itemize}
\end{frame}

\begin{frame}{Current Sage approach}
    \begin{itemize}
        \item
            Compute a lower bound -- rational cuspidal subgroup.
        \item
            Compute an upper bound -- reduction modulo primes.
        \item
            Hope they agree. 
        \item
            They probably won't.
        \item
            The first example is $J_0(30)$ which is
            isogenous to a product of 3 elliptic curves.
    \end{itemize}
\end{frame}

\begin{frame}{Upper bound}
    \begin{itemize}
        \item 
            Let $A$ be an abelian variety defined over a number field $K$.
            Suppose $\p$ is an unramified prime of $K$ of odd residue
            characteristic. Then $A(K)_\tor \hookrightarrow A_\p(\FF_\p)$.
        \item
            Applying to our case,
            \[
                \#J_0(N)(\QQ)_\tor \mid  \gcd_{p\nmid 2N, p\leq 50} \#J_0(N)_p
                (\FF_p),
            \]
            where $\# J_0(N)_p(\FF_p)=\mathrm{charpoly}(\Frob_p)(1)
            =\mathrm{charpoly}(T_p)(p+1)$.
        \item
            The right hand side is an isogeny invariant so we expect it not to
            be tight. In fact, there's an abelian variety isogenous to
            $J_0(30)$ with strictly larger torsion order.
    \end{itemize}
\end{frame}

\begin{frame}{$J_0(30)$}
    \Large{$J_0(30)$ is the motivating example for the first half of my thesis}
\end{frame}

\begin{frame}{Shimura subgroup}
    \begin{definition}
        The Shimura subgroup, $\Sigma$, of $J_0(N)$ is the kernel of the
        natural degeneracy map $J_0(N)\to J_1(N)$.
    \end{definition}
\end{frame}

\begin{frame}{Degeneracy maps and the old-subvariety}
    \begin{itemize}
        \item 
            Let $L$ be a divisor of $N$. For every divisor $t_1,\ldots,t_r$ of
            $N/L$, there exists a morphism $d_t:J_0(L)\to J_0(N)$, called the
            degeneracy map. This map has finite kernel.
        \item
            Let $\Phi_L ^r: J_0(L)^r \to J_0(N)$ be given by
            \[
                \Phi_L(x_1,\ldots,x_r)=d_{t_1}(x_1)+\cdots+d_{t_r}(x_r).
            \]
            The image of this map is called the $N/L$-old subvariety.
    \end{itemize}
\end{frame}

\begin{frame}{Direct sum decomposition}
    \begin{itemize}
        \item 
            Let $\Phi_L ^r: J_0(L)^r \to J_0(N)$ be given by
            \[
                \Phi_L(x_1,\ldots,x_r)=d_{t_1}(x_1)+\cdots+d_{t_r}(x_r).
            \]
        \item
            Let $\Sigma(L)_0 ^r = \{(x_1,\ldots,x_r)\in \Sigma(L)^r: \sum
            x_i=0\}\subseteq J_0(L)^r$.
        \end{itemize}
\end{frame}

\begin{frame}{Direct Sum Decomposition}

    \begin{proposition}[L.]
        Suppose that $\ker\Phi_L ^r = \Sigma(L)_0 ^r$ and $E=J_0(L)$ is an elliptic
        curve. Then there is a $\QQ$-isomorphism
        \[
            \Im\Phi_L ^N \cong E \times F^{r-1},
        \]
        where $F$ is the $J_1(L)$-optimal curve in the isogeny class of $E$.
    \end{proposition}
    \begin{theorem}[Ribet '90]
        If $N/L=p$ is a prime coprime to $L$, then $\ker\Phi_L ^r = \Sigma(L)_0
        ^r$.
    \end{theorem}
    Later generalized. (Ling '95)
\end{frame}

\begin{frame}{Computing $J_0(30)(\QQ)_\tor$}
    \begin{itemize}
        \item
            We have $\# C(\QQ) = 192$ and an upper bound is $768$.
        \item
            $J_0(30)=J_\old+J_\new$, with $J_\old=E_1+E_2$, where $E_i$ are
            elliptic curves of conductor 15 and $J_\new=E_3$, where $E_3$ is a
            elliptic curve of conductor 30.
        \item
            Since $30/15=2$, $J_\old$ breaks up as a direct sum so we can
            determine $\# J_\old  = 32$ which is the order of $C(\QQ)\cap
            J_\old$.
    \end{itemize}
\end{frame}

\begin{frame}[standout]{Galois Cohomology}
    \Huge{Blackboard time}
\end{frame}

\begin{frame}{The totally split hope}
    \begin{itemize}
        \item 
            The rational torsion points of elliptic curves can be determined
            using Nagell-Lutz.
        \item
            Using some Galois cohomology, we can try to reconstruct the
            rational torsion of $J_0(N)$ from its elliptic factors.
    \end{itemize}
\end{frame}


\begin{frame}{Totally split $J_0(N)$}
    \begin{definition}
        A Jacobian $J_0(N)$ is \emph{totally split} if it is isogenous over
        $\QQ$ to a product of elliptic curves.
    \end{definition}
\end{frame}

\begin{frame}{Enumerating totally split $J_0(N)$}
    \begin{theorem}[L.]
        There are 71 nontrivial totally split $J_0(N)$. We can provably
        enumerate them all. The largest is $J_0(1200)$.
    \end{theorem}
\end{frame}

\begin{frame}{Sketch of proof}
    \begin{block}{Lemma}
    The only possible primes $p$, where $J_0(p)$ is totally split are
    \[
        2, 3, 5, 7, 11, 13, 17, 19, 37.
    \]
    \end{block}
    \begin{proof}
        \begin{itemize}
            \item 
                The rational torsion order of $J_0(p)$ is $n=\num((p-1)/12)$.
            \item
                If a prime $\ell$ divides $n$ then $\ell$ divides the rational
                torsion order of some elliptic curve of prime conductor.
            \item
                Elliptic curves of prime conductor don't have much rational
                torsion.
        \end{itemize}
   \end{proof}
    Call an integer $N$ \emph{good} if $J_0(N)$ is totally split and
    \emph{bad}, otherwise. There is an isogeny from $J_0(N)$ to $J_0(NM)$. So
    if $N$ is bad so are all the multiples.

    So we do a breadth-first search on the divisible tree of positive integers
    supported on the good prime. The previous condition allows us to prune
    branches.
\end{frame}

\begin{frame}{Results}
\begin{table}%
    \label{tab:rank_zero_bound}
    \caption{Bound on $[J_0(N)(\QQ)_\tor:C(N)(\QQ)]$}
    \centering
    \begin{tabular}{rr}
        \toprule
        $N$ & bound \\
        \midrule
        84 & 8 \\
        90 & 16 \\
        96 & 64 \\
        120 & 512 \\
        132 & 32 \\
        \bottomrule
    \end{tabular}
    \begin{tabular}{rr}
        \toprule
        $N$ & bound \\
        \midrule
        144 & 64 \\
        150 & 16 \\
        168 & 512 \\
        180 & 128  \\
            &  \\
        \bottomrule
    \end{tabular}
\end{table}
\end{frame}

\section{Enumerating the odd-isogeny class of simple abelian subvarieties of
$J_0(N)$ with $N$ prime}

\begin{frame}{Working on paper with Hao and William}
    \begin{itemize}
        \item 
            One of the sections in this paper is giving methods for enumerating
            the rational isogeny class of modular abelian varieties. 
        \item
            In general, this seems hopelessly difficult.
        \item
            But Frank Calegari had an idea for a special case!
    \end{itemize} 
\end{frame}

\begin{frame}{F. Calegari's Theorem}
    Let $A\subseteq J_0(N)$ be a simple abelian variety with $N$ prime and
    $\TT_A = \Im(\TT\to \End(A))$ integrally closed. Let $\H$ be a set of
    odd integral representatives for $\Cl(\TT_A)$.
    \begin{theorem}[F. Calegari]
        Suppose $\phi:A\to A'$ be an isogeny with $\ker\phi$ supported only on the
        non-Eisenstein primes of odd residue characteristic. Then
        \[
            A'\cong A/A[C]
        \]
        for some $C\in \H$.
    \end{theorem}
    Though there are infinitely many non-Eisenstein primes away from 2, this
    theorem reduces the isogenies supported on these primes to just a finite
    list!
\end{frame}

\begin{frame}{Some experimental data}
    \begin{itemize}
        \item 
            There are [[this many]] simple abelian subvarieties, $A$, of
            $J_0(N)$ with $\dim(A)\leq [[bound]]$ and $N\leq [[bound]]$
        \item
            For [[this many]] of [[this many]], [[this many]] are integrally
            closed.
        \item
            For all of these abelian subvarieties, $\Cl(\TT_A)$ is trivial.
    \end{itemize} 
\end{frame}

\begin{frame}{Restating in terms Galois submodules}
    \begin{itemize}
        \item 
            The image of an isogeny is determined by its kernel up to isomorphism. 
        \item
            Define an equivalence relation on the set of finite odd-order
            $G_\QQ$-submodules of $A(\QQbar)$ given by $M_1\sim M_2$ if and only if
            $A/M_1\cong A/M_2$.
        \item
            So the goal is to enumerate the odd-order $G_\QQ$-submodules of
            $A(\QQbar)_\mathrm{odd}$.
    \end{itemize}
\end{frame}

\begin{frame}{Making sense of F. Calegari's theorem}
    \begin{proposition}
        Suppose $M$ is a finite odd-order $G_\QQ$-submodule of $J_0(N)$, with $N$
        prime. Then $M$ is a $\TT[G_\QQ]$-module.

        In particular, if $A\subseteq J_0(N)$, we can refer to the support of
        $M\subseteq A$ as a $\TT_A$-module.
    \end{proposition}
\end{frame}

\begin{frame}{Finite odd-order Galois modules are Hecke}
    Let $M$ be a finite odd-order Galois module of $J_0(N)$. Let $\TT$ be the
    Hecke algebra of $J_0(N)$. Want to show $\TT M = M$.
    \begin{itemize}
        \item
            It suffices to prove this on $\ell$-primary parts for prime
            $\ell>2$. It suffices to prove this for each each
            $G_\QQ$-composition factor of $M$. 
        \item
            So assume $M$ is $\ell$-torsion.
        \item
            Ribet ('91) shows that $\TT/\ell \TT$ is generated by $T_p$ for
            $p\nmid \ell N$. So it suffices to show $T_p M \subseteq M$.
        \item
            By Eichler-Shimura, $T_p = F+p/F\in \End(J_{/\F_p})$, where $F$ is
            Frobenius. So we derivate the $T_p$-stability from its
            $G_\QQ$-stability.
    \end{itemize}
\end{frame}

\begin{frame}{Non-eisenstein implies kernel of Hecke}
    \begin{theorem}[Helm]
        Let $M$ be a finite odd-order $G_\QQ$-module supported, as a $\TT$-module,
        only on the non-Eisenstein primes. If $I=\Ann_\TT(M)$, then $M=J[I]$.

        Moreover, since $A$ is both $\TT[G_\QQ]$-invariant, if $M$ is a finite
        odd-order $G_\QQ$-submodule of $A(\QQbar)$ supported, as a $\TT_A$-module,
        only on the non-Eisenstein primes. If $I=\Ann_{\TT_A}(M)$, then $M=A[I]$.
    \end{theorem}
\end{frame}

\begin{frame}{General Idea}
    \begin{itemize}
        \item 
            Enumerate, up to equivalence, the finite odd-order submodules
            supported on the non-Eisenstein primes. Done by F. Calegari!
        \item
            Enumerate, up to equivalence, the finite odd-order submodules
            supported on the non-Eisenstein primes. To come!
        \item
            Put them together to enumerate the odd-degree isogeny class.
    \end{itemize}
\end{frame}

\begin{frame}{Eisenstein isogenies}
   Under these really annoying conditions, we can enumerate the Eisenstein
   isogenies. 
\end{frame}

    
\end{document}
